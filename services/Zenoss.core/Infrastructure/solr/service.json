{
    "Name": "Solr",
    "Description": "Solr Cloud",
    "Command": "/opt/solr/bin/solr -f -cloud -s /opt/solr/server/solr -DzkHost={{with $zks := (child (child (parent .) \"HBase\") \"ZooKeeper\").Instances }}{{range (each $zks)}}127.0.0.1:{{plus 2181 .}}{{if ne (plus 1 .) $zks}},{{end}}{{end}}{{end}}",
    "ImageID": "zenoss/zenoss5x",
    "ConfigFiles": {
      "/opt/solr/server/solr/solr.xml": {
        "FileName": "/opt/solr/server/solr/solr.xml",
        "Owner": "root:root",
        "Permissions": "0664"
      }
    },
    "Endpoints": [
        {
            "Name": "solr",
            "Application": "zodb_solr",
            "PortNumber": 8983,
            "Protocol": "tcp",
            "purpose": "export",
            "Vhosts": ["solr"]
        },
        {
            "Application": "zookeeper-client",
            "Name": "zookeeper-client",
            "portnumber": 2181,
            "Protocol": "tcp",
            "Purpose": "import_all"
        }
    ],
    "Instances": {
        "min": 1,
        "max": 5,
        "default": 2
    },
    "RAMCommitment": "1G",
    "CPUCommitment": 2,
    "Launch": "auto",
    "LogConfigs": [],
    "Tags": [
        "daemon"
    ],
    "Volumes": [
        {
            "#####":         "drwxr-x--- 4 solr solr 4096 Feb 25 21:25 /opt/solr/server/lib",
            "Owner":         "solr:solr",
            "Permission":    "0750",
            "ResourcePath":  "solr-{{.InstanceID}}",
            "ContainerPath": "/opt/solr/server/lib"
        }
    ],
    "HealthChecks": {
      "ping": {
        "Command": "curl -s http://127.0.0.1:8983/solr/zenoss_model/ping | grep -q solrpingqueryidallfalse10OK",
        "Interval": 30
      }
    }
}
